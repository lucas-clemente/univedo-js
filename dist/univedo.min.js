(function(){(function(t){var e,r,s,i,n,a,o,f,u;for(n=[],a={},o=u=0;255>=u;o=++u)n[o]=(o+256).toString(16).substr(1),a[n[o]]=o;return f=function(t){return o=0,n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+"-"+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]+n[t[o++]]},r={UINT:0,NEGINT:1,BYTESTRING:2,TEXTSTRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE:7},i={DECIMAL:4,REMOTEOBJECT:6,UUID:7,TIME:8,DATETIME:9,SQL:10},s={FALSE:20,TRUE:21,NULL:22,FLOAT32:26,FLOAT64:27},t.Message=e=function(){function t(t){this.buffer=t,this.offset=0}return t.prototype.getDataView=function(t){var e;return e=new DataView(this.buffer,this.offset,t),this.offset+=t,e},t.prototype.getLen=function(t){var e;switch(e=31&t){case 24:return this.getDataView(1).getUint8(0);case 25:return this.getDataView(2).getUint16(0);case 26:return this.getDataView(4).getUint32(0);case 27:throw"int64 not yet supported in javascript!";default:return e}},t.prototype.read=function(){var t,e,n,a,u,c,h,T,l,g;switch(u=this.getDataView(1).getUint8(0),e=u>>5){case r.UINT:return this.getLen(u);case r.NEGINT:return-this.getLen(u)-1;case r.SIMPLE:switch(31&u){case s.FALSE:return!1;case s.TRUE:return!0;case s.NULL:return null;case s.FLOAT32:return this.getDataView(4).getFloat32(0);case s.FLOAT64:return this.getDataView(8).getFloat64(0);default:throw"invalid simple in cbor protocol"}break;case r.BYTESTRING:return t=this.getLen(u),this.buffer.slice(this.offset,this.offset+=t);case r.TEXTSTRING:return t=this.getLen(u),String.fromCharCode.apply(null,new Uint8Array(this.buffer.slice(this.offset,this.offset+=t)));case r.ARRAY:for(t=this.getLen(u),g=[],o=c=0,T=t-1;T>=0?T>=c:c>=T;o=T>=0?++c:--c)g.push(this.read());return g;case r.MAP:for(t=this.getLen(u),n={},o=h=0,l=t-1;l>=0?l>=h:h>=l;o=l>=0?++h:--h)n[this.read()]=this.read();return n;case r.TAG:switch(a=this.getLen(u)){case i.TIME:case i.DATETIME:return new Date(this.read());case i.UUID:return f(this.buffer.slice(this.offset,this.offset+=16));default:throw"invalid tag in cbor protocol"}break;default:throw"invalid major in cbor protocol"}},t}(),null})("undefined"!=typeof exports&&null!==exports?exports:this)}).call(this);